<?xml version="1.0" encoding="UTF-8"?>
<TestScript xmlns="http://hl7.org/fhir" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir ../../schema/testscript.xsd">
  <id value="2014-02-washington-ts"/>
  <name value="Terminology Connectathon #1 Test Script"/>
  <description value="This is the test script the 1st Terminology Services Connectathon"/>

  <fixture id="extensional-case-1">
    <resource>
      <ValueSet xmlns="http://hl7.org/fhir">
        <id value="extensional-case-1"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">A selection of codes from http://hl7.org/fhir/patient-contact-relationship</div>
        </text>
        <identifier value="http://www.healthintersections.com.au/fhir/ValueSet/extensional-case-1"/>
        <name value="Terminology Services Connectation #1 Extensional case #1"/>
        <publisher value="Grahame Grieve"/>
        <telecom>
          <system value="email"/>
          <value value="grahame@healthintersections.com.au"/>
        </telecom>
        <description value="an enumeration of codes defined by FHIR itself"/>
        <status value="draft"/>
        <experimental value="true"/>
        <compose>
          <include>
            <!-- note - the source for this is at http://hl7-fhir.github.io/valueset-patient-contact-relationship.html -->
            <system value="http://hl7.org/fhir/patient-contact-relationship"/>
            <concept>
              <code value="emergency"/>
              <display value="Emergency"/>
            </concept>
            <concept>
              <code value="family"/>
              <display value="Family"/>
            </concept>
            <concept>
              <code value="guardian"/>
              <display value="Guardian"/>
            </concept>
            <concept>
              <code value="friend"/>
              <display value="Friend"/>
            </concept>
            <concept>
              <code value="partner"/>
              <display value="Partner"/>
            </concept>
            <concept>
              <code value="work"/>
              <display value="Work"/>
            </concept>
            <concept>
              <code value="parent"/>
              <display value="Parent"/>
            </concept>
          </include>
        </compose>
      </ValueSet>
    </resource>
  </fixture>
  <fixture id="extensional-case-2">
    <resource>
      <ValueSet xmlns="http://hl7.org/fhir">
        <id value="extensional-case-2"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">A selection of codes from http://loinc.org</div>
        </text>
        <identifier value="http://www.healthintersections.com.au/fhir/ValueSet/extensional-case-2"/>
        <name value="Terminology Services Connectation #1 Extensional case #2"/>
        <publisher value="Grahame Grieve"/>
        <telecom>
          <system value="email"/>
          <value value="grahame@healthintersections.com.au"/>
        </telecom>
        <description value="an enumeration of codes defined by LOINC"/>
        <status value="draft"/>
        <experimental value="true"/>
        <compose>
          <include>
            <system value="http://loinc.org"/>
            <concept>
              <code value="11378-7"/>
              <display value="Systolic blood pressure at First encounter"/>
            </concept>
            <concept>
              <code value="8493-9"/>
              <display value="Systolic blood pressure 10 hour minimum"/>
            </concept>
            <concept>
              <code value="8494-7"/>
              <display value="Systolic blood pressure 12 hour minimum"/>
            </concept>
            <concept>
              <code value="8495-4"/>
              <display value="Systolic blood pressure 24 hour minimum"/>
            </concept>
            <concept>
              <code value="8450-9"/>
              <display value="Systolic blood pressure--expiration"/>
            </concept>
            <concept>
              <code value="8451-7"/>
              <display value="Systolic blood pressure--inspiration"/>
            </concept>
            <concept>
              <code value="8452-5"/>
              <display value="Systolic blood pressure.inspiration - expiration"/>
            </concept>
            <concept>
              <code value="8459-0"/>
              <display value="Systolic blood pressure--sitting"/>
            </concept>
            <concept>
              <code value="8460-8"/>
              <display value="Systolic blood pressure--standing"/>
            </concept>
            <concept>
              <code value="8461-6"/>
              <display value="Systolic blood pressure--supine"/>
            </concept>
            <concept>
              <code value="8479-8"/>
              <display value="Systolic blood pressure by palpation"/>
            </concept>
            <concept>
              <code value="8480-6"/>
              <display value="Systolic blood pressure"/>
            </concept>
            <concept>
              <code value="8481-4"/>
              <display value="Systolic blood pressure 1 hour maximum"/>
            </concept>
            <concept>
              <code value="8482-2"/>
              <display value="Systolic blood pressure 8 hour maximum"/>
            </concept>
            <concept>
              <code value="8483-0"/>
              <display value="Systolic blood pressure 10 hour maximum"/>
            </concept>
            <concept>
              <code value="8484-8"/>
              <display value="Systolic blood pressure 12 hour maximum"/>
            </concept>
            <concept>
              <code value="8485-5"/>
              <display value="Systolic blood pressure 24 hour maximum"/>
            </concept>
            <concept>
              <code value="8486-3"/>
              <display value="Systolic blood pressure 1 hour mean"/>
            </concept>
            <concept>
              <code value="8487-1"/>
              <display value="Systolic blood pressure 8 hour mean"/>
            </concept>
            <concept>
              <code value="8488-9"/>
              <display value="Systolic blood pressure 10 hour mean"/>
            </concept>
            <concept>
              <code value="8489-7"/>
              <display value="Systolic blood pressure 12 hour mean"/>
            </concept>
            <concept>
              <code value="8490-5"/>
              <display value="Systolic blood pressure 24 hour mean"/>
            </concept>
            <concept>
              <code value="8491-3"/>
              <display value="Systolic blood pressure 1 hour minimum"/>
            </concept>
            <concept>
              <code value="8492-1"/>
              <display value="Systolic blood pressure 8 hour minimum"/>
            </concept>
          </include>
        </compose>
      </ValueSet>
    </resource>
  </fixture>
  <fixture id="extensional-case-3">
    <resource>
      <ValueSet xmlns="http://hl7.org/fhir">
        <id value="extensional-case-3"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">A selection of codes from http://snomed.info/sct</div>
        </text>
        <identifier value="http://www.healthintersections.com.au/fhir/ValueSet/extensional-case-3"/>
        <name value="Terminology Services Connectation #1 Extensional case #3"/>
        <publisher value="Grahame Grieve"/>
        <telecom>
          <system value="email"/>
          <value value="grahame@healthintersections.com.au"/>
        </telecom>
        <description value="an enumeration of codes defined by SNOMED"/>
        <status value="draft"/>
        <experimental value="true"/>
        <compose>
          <include>
            <system value="http://snomed.info/sct"/>
            <concept>
              <code value="371037005"/>
              <display value="Systolic dysfunction"/>
            </concept>
            <concept>
              <code value="56218007"/>
              <display value="Systolic hypertension"/>
            </concept>
            <concept>
              <code value="271657009"/>
              <display value="Systolic cardiac thrill"/>
            </concept>
            <concept>
              <code value="429457004"/>
              <display value="Systolic essential hypertension"/>
            </concept>
            <concept>
              <code value="417996009"/>
              <display value="Systolic heart failure"/>
            </concept>
            <concept>
              <code value="44623008"/>
              <display value="Systolic ejection sound"/>
            </concept>
            <concept>
              <code value="248677002"/>
              <display value="Systolic flow murmur"/>
            </concept>
            <concept>
              <code value="31574009"/>
              <display value="Systolic murmur"/>
            </concept>
            <concept>
              <code value="120871000119108"/>
              <display value="Systolic heart failure stage B"/>
            </concept>
            <concept>
              <code value="120851000119104"/>
              <display value="Systolic heart failure stage D"/>
            </concept>
            <concept>
              <code value="120861000119102"/>
              <display value="Systolic heart failure stage C"/>
            </concept>
            <concept>
              <code value="609556008"/>
              <display value="Systolic heart failure stage A"/>
            </concept>
            <concept>
              <code value="61926008"/>
              <display value="Basal systolic thrill"/>
            </concept>
            <concept>
              <code value="248672008"/>
              <display value="Soft systolic murmur"/>
            </concept>
            <concept>
              <code value="65254001"/>
              <display value="Late systolic murmur"/>
            </concept>
            <concept>
              <code value="89985004"/>
              <display value="Early systolic murmur"/>
            </concept>
            <concept>
              <code value="248692001"/>
              <display value="Mid-systolic click"/>
            </concept>
            <concept>
              <code value="248678007"/>
              <display value="Mitral late systolic murmur"/>
            </concept>
            <concept>
              <code value="443254009"/>
              <display value="Acute systolic heart failure"/>
            </concept>
            <concept>
              <code value="441481004"/>
              <display value="Chronic systolic heart failure"/>
            </concept>
            <concept>
              <code value="48965007"/>
              <display value="Single non-ejection systolic click"/>
            </concept>
            <concept>
              <code value="68519006"/>
              <display value="Multiple non-ejection systolic clicks"/>
            </concept>
            <concept>
              <code value="134401001"/>
              <display value="Left ventricular systolic dysfunction"/>
            </concept>
            <concept>
              <code value="416158002"/>
              <display value="Right ventricular systolic dysfunction"/>
            </concept>
            <concept>
              <code value="68494000"/>
              <display value="Mid-systolic murmur"/>
            </concept>
            <concept>
              <code value="442304009"/>
              <display value="Combined systolic and diastolic dysfunction"/>
            </concept>
            <concept>
              <code value="18352002"/>
              <display value="Abnormal systolic arterial pressure"/>
            </concept>
            <concept>
              <code value="407596008"/>
              <display value="Echocardiogram shows left ventricular systolic dysfunction"/>
            </concept>
            <concept>
              <code value="371857005"/>
              <display value="Normal left ventricular systolic function and wall motion"/>
            </concept>
            <concept>
              <code value="430396006"/>
              <display value="Chronic systolic dysfunction of left ventricle"/>
            </concept>
            <concept>
              <code value="12929001"/>
              <display value="Normal systolic arterial pressure"/>
            </concept>
            <concept>
              <code value="275285009"/>
              <display value="On examination - systolic murmur"/>
            </concept>
            <concept>
              <code value="443253003"/>
              <display value="Acute on chronic systolic heart failure"/>
            </concept>
            <concept>
              <code value="371862006"/>
              <display value="Depression of left ventricular systolic function"/>
            </concept>
            <concept>
              <code value="81010002"/>
              <display value="Decreased systolic arterial pressure"/>
            </concept>
            <concept>
              <code value="163030003"/>
              <display value="On examination - Systolic BP reading"/>
            </concept>
            <concept>
              <code value="163069009"/>
              <display value="On examination - systolic cardiac thrill"/>
            </concept>
            <concept>
              <code value="18050000"/>
              <display value="Increased systolic arterial pressure"/>
            </concept>
            <concept>
              <code value="163094005"/>
              <display value="On examination - pulmonary systolic murmur"/>
            </concept>
            <concept>
              <code value="426263006"/>
              <display value="Congestive heart failure due to left ventricular systolic dysfunction"/>
            </concept>
            <concept>
              <code value="417081007"/>
              <display value="Systolic anterior movement of mitral valve"/>
            </concept>
            <concept>
              <code value="248679004"/>
              <display value="Mitral pansystolic murmur"/>
            </concept>
            <concept>
              <code value="248687003"/>
              <display value="Presystolic mitral murmur"/>
            </concept>
            <concept>
              <code value="248688008"/>
              <display value="Presystolic tricuspid murmur"/>
            </concept>
            <concept>
              <code value="71201008"/>
              <display value="Pansystolic murmur"/>
            </concept>
            <concept>
              <code value="23795000"/>
              <display value="Presystolic murmur"/>
            </concept>
            <concept>
              <code value="23795000"/>
              <display value="Presystolic murmur"/>
            </concept>
            <concept>
              <code value="248680001"/>
              <display value="Tricuspid inspiratory pansystolic murmur"/>
            </concept>
            <concept>
              <code value="248681002"/>
              <display value="Left parasternal pansystolic murmur"/>
            </concept>
          </include>
        </compose>
      </ValueSet>
    </resource>
  </fixture>
  <fixture id="extensional-case-4">
    <resource>
      <ValueSet xmlns="http://hl7.org/fhir">
        <id value="extensional-case-4"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">A selection of codes from http://hl7.org/fhir/patient-contact-relationship</div>
        </text>
        <identifier value="http://www.healthintersections.com.au/fhir/ValueSet/extensional-case-4"/>
        <name value="Terminology Services Connectation #1 Extensional case #4"/>
        <publisher value="Grahame Grieve"/>
        <telecom>
          <system value="email"/>
          <value value="grahame@healthintersections.com.au"/>
        </telecom>
        <description value="A mixed enumeration of codes from FHIR, and from V3 role code"/>
        <status value="draft"/>
        <experimental value="true"/>
        <compose>
          <include>
            <system value="http://hl7.org/fhir/patient-contact-relationship"/>
            <concept>
              <code value="emergency"/>
              <display value="Emergency"/>
            </concept>
            <concept>
              <code value="family"/>
              <display value="Family"/>
            </concept>
            <concept>
              <code value="guardian"/>
              <display value="Guardian"/>
            </concept>
            <concept>
              <code value="friend"/>
              <display value="Friend"/>
            </concept>
            <concept>
              <code value="partner"/>
              <display value="Partner"/>
            </concept>
            <concept>
              <code value="work"/>
              <display value="Work"/>
            </concept>
          </include>
          <include>
            <system value="http://hl7.org/fhir/v3/RoleCode"/>
            <concept>
              <code value="CHILD"/>
              <display value="child"/>
            </concept>
            <concept>
              <code value="FTH"/>
              <display value="father"/>
            </concept>
            <concept>
              <code value="MTH"/>
              <display value="mother"/>
            </concept>
          </include>
        </compose>
      </ValueSet>
    </resource>
  </fixture>
  <fixture id="intensional-case-1">
    <resource>
      <ValueSet xmlns="http://hl7.org/fhir">
        <id value="intensional-case-1"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">All loinc codes for system = Arterial system</div>
        </text>
        <identifier value="http://www.healthintersections.com.au/fhir/ValueSet/intensional-case-1"/>
        <name value="Terminology Services Connectation #1 Intensional case #1"/>
        <publisher value="Grahame Grieve"/>
        <telecom>
          <system value="email"/>
          <value value="grahame@healthintersections.com.au"/>
        </telecom>
        <description value="All loinc codes for system = Arterial system"/>
        <status value="draft"/>
        <experimental value="true"/>
        <compose>
          <include>
            <system value="http://loinc.org"/>
            <filter>
              <property value="SYSTEM"/>
              <op value="="/>
              <value value="Arterial system"/>
            </filter>
          </include>
        </compose>
      </ValueSet>
    </resource>
  </fixture>
  <fixture id="intensional-case-2">
    <resource>
      <ValueSet xmlns="http://hl7.org/fhir">
        <id value="intensional-case-2"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">All Snomed codes that are subsumed by 38341003 (Hypertensive disorder, systemic arterial)</div>
        </text>
        <identifier value="http://www.healthintersections.com.au/fhir/ValueSet/intensional-case-2"/>
        <name value="Terminology Services Connectation #1 Intensional case #2"/>
        <publisher value="Grahame Grieve"/>
        <telecom>
          <system value="email"/>
          <value value="grahame@healthintersections.com.au"/>
        </telecom>
        <description value="All Snomed codes that are subsumed by 38341003 (Hypertensive disorder, systemic arterial)"/>
        <status value="draft"/>
        <experimental value="true"/>
        <compose>
          <include>
            <system value="http://snomed.info/sct"/>
            <filter>
              <property value="concept"/>
              <op value="is-a"/>
              <value value="38341003"/>
            </filter>
          </include>
        </compose>
      </ValueSet>
    </resource>
  </fixture>
  <fixture id="intensional-case-3">
    <resource>
      <ValueSet xmlns="http://hl7.org/fhir">
        <id value="intensional-case-3"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">All Snomed codes that are subsumed by 404684003 (Clinical Finding)</div>
        </text>
        <identifier value="http://www.healthintersections.com.au/fhir/ValueSet/intensional-case-3"/>
        <name value="Terminology Services Connectation #1 Intensional case #3"/>
        <publisher value="Grahame Grieve"/>
        <telecom>
          <system value="email"/>
          <value value="grahame@healthintersections.com.au"/>
        </telecom>
        <description value="All Snomed codes that are subsumed by 404684003 (Clinical Finding)"/>
        <status value="draft"/>
        <experimental value="true"/>
        <compose>
          <include>
            <system value="http://snomed.info/sct"/>
            <filter>
              <property value="concept"/>
              <op value="is-a"/>
              <value value="404684003"/>
            </filter>
          </include>
        </compose>
      </ValueSet>
    </resource>
  </fixture>

  <setup>
    <operation>
      <type value="create"/>
      <source value="extensional-case-1"/>
    </operation>
    <operation>
      <type value="create"/>
      <source value="extensional-case-2"/>
    </operation>
    <operation>
      <type value="create"/>
      <source value="extensional-case-3"/>
    </operation>
    <operation>
      <type value="create"/>
      <source value="extensional-case-4"/>
    </operation>
    <operation>
      <type value="create"/>
      <source value="intensional-case-1"/>
    </operation>
    <operation>
      <type value="create"/>
      <source value="intensional-case-2"/>
    </operation>
    <operation>
      <type value="create"/>
      <source value="intensional-case-3"/>
    </operation>
  </setup>

<!-- These tests are from suite1 - Simple Expansion Tests -->
<!-- Add min xpath comparisons -->
  <test id="test1-1">
    <name value="Fixed expansion #1"/>
    <description value="Expanding a fixed limited value set, case #1"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-1"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test1-2">
    <name value="Fixed expansion #2"/>
    <description value="Expanding a fixed limited value set, case #2"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-2"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test1-3">
    <name value="Fixed expansion #3"/>
    <description value="Expanding a fixed limited value set, case #3"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-3"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test1-4">
    <name value="Fixed expansion #4"/>
    <description value="Expanding a fixed limited value set, case #4"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-4"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test1-5">
    <name value="Fixed expansion #5"/>
    <description value="Expanding a fixed limited value set, case #5"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="intensional-case-1"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test1-6">
    <name value="Fixed expansion #6"/>
    <description value="Expanding a fixed limited value set, case #6"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="intensional-case-2"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test1-7">
    <name value="Fixed expansion #7"/>
    <description value="Expanding a fixed limited value set, case #7"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="intensional-case-3"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

<!-- These tests are from suite2 - Expansion Tests with a text filter -->

  <test id="test2-1">
    <name value="Fixed expansion #1 + text filter"/>
    <description value="Expanding a fixed limited value set with a text filter 'f', case #1"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-1"/>
      <parameter value="filter=f"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test2-2">
    <name value="Fixed expansion with text filter #2"/>
    <description value="Expanding a fixed limited value set with a text filter 'mean', case #2"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-2"/>
      <parameter value="filter=mean"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test2-3">
    <name value="Fixed expansion with text filter #3"/>
    <description value="Expanding a fixed limited value set with text filter 'fail', case #3"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-3"/>
      <parameter value="filter=fail"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test2-4">
    <name value="Fixed expansion with a text filter #4"/>
    <description value="Expanding a fixed limited value set with a text filter 'f', case #4"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="extensional-case-4"/>
      <parameter value="filter=f"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test2-5">
    <name value="Intensional expansion with text filter #1"/>
    <description value="Expanding an intensional value set with text filter 'exp', case #1"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="intensional-case-1"/>
      <parameter value="filter=exp"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test2-6">
    <name value="intensional expansion with text filter #2"/>
    <description value="Expanding an intensional value set with text filter = chronic, case #2"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="intensional-case-2"/>
      <parameter value="filter=chronic"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test2-7">
    <name value="intensional expansion with text filter #3"/>
    <description value="Expanding an intensional value set with text filter='renin', case #3"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $expand"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$expand"/>
      </validates>
    </metadata>
    <operation>
      <type value="$expand"/>
      <target value="intensional-case-3"/>
      <parameter value="filter=renin"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>

<!-- These tests are from suite3 - Basic Validation Tests -->

  <test id="test3-1-a">
    <name value="Validation valueset #1 valid"/>
    <description value="Check that the code {http://hl7.org/fhir/patient-contact-relationship}emergency is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-1"/>
      <parameter value="system=http://hl7.org/fhir/patient-contact-relationship"/>
      <parameter value="code=emergency"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test3-1-b">
    <name value="Validation valueset #1 invalid system"/>
    <description value="Check that the code {http://hl7.org/fhir/patient-contact-relationshipX}emergency is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-1"/>
      <parameter value="system=http://hl7.org/fhir/patient-contact-relationshipX"/>
      <parameter value="code=emergency"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-1-c">
    <name value="Validation valueset #1 invalid code"/>
    <description value="Check that the code {http://hl7.org/fhir/patient-contact-relationship}emergencyX is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-1"/>
      <parameter value="system=http://hl7.org/fhir/patient-contact-relationship"/>
      <parameter value="code=emergencyX"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

  <test id="test3-2-a">
    <name value="Validation valueset #2 valid"/>
    <description value="Check that the code {http://loinc.org}11378-7 'Systolic blood pressure at First encounter' is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-2"/>
      <parameter value="system=http://loinc.org"/>
      <parameter value="code=11378-7"/>
      <parameter value="display=Systolic%20blood%20pressure%20at%20First%20encounter"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test3-2-b">
    <name value="Validation valueset #2 valid code invalid display"/>
    <description value="Check that the code {http://loinc.org}11378-7 'Systolic blood pressure at First encounter' is in the value set, but supply a wrong display"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-2"/>
      <parameter value="system=http://loinc.org"/>
      <parameter value="code=11378-7"/>
      <parameter value="display=Systolic%20blood%20pressure%20at%20First%20encounterX"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-2-c">
    <name value="Validation valueset #2 invalid system"/>
    <description value="Check that the code {http://loinc.orgX}11378-7 'Systolic blood pressure at First encounter' is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-2"/>
      <parameter value="system=http://loinc.orgX"/>
      <parameter value="code=11378-7"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-2-d">
    <name value="Validation valueset #2 invalid code"/>
    <description value="Check that the code {http://loinc.org}11378-7X 'Systolic blood pressure at First encounter' is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-2"/>
      <parameter value="system=http://loinc.org"/>
      <parameter value="code=11378-7X"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-2-e">
    <name value="Validation valueset #2 valid code not in valid set"/>
    <description value="Check that the code {http://loinc.org}13457-7 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-2"/>
      <parameter value="system=http://loinc.org"/>
      <parameter value="code=13457-7"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

  <test id="test3-3-a">
    <name value="Validation valueset #3 valid"/>
    <description value="Check that the code {http://snomed.info/sct}371037005 'Systolic dysfunction' is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=371037005"/>
      <parameter value="display=Systolic%20dysfunction"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test3-3-b">
    <name value="Validation valueset #3 valid code invalid display"/>
    <description value="Check that the code {http://snomed.info/sct}371037005 'Systolic dysfunction' is in the value set, but give the wrong display`"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=371037005"/>
      <parameter value="display=Systolic%20dysfunctionX"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-3-c">
    <name value="Validation valueset #3 invalid system"/>
    <description value="Check that the code {http://snomed.info/sctX}371037005 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-3"/>
      <parameter value="http://snomed.info/sctX"/>
      <parameter value="code=371037005"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-3-d">
    <name value="Validation valueset #3 invalid code"/>
    <description value="Check that the code {http://snomed.info/sct}371037005X is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=371037005X"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-3-e">
    <name value="Validation valueset #3 valid code not in valid set"/>
    <description value="Check that the code {http://snomed.info/sct}102261002 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=102261002"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

  <test id="test3-4-a">
    <name value="Validation valueset #4 valid"/>
    <description value="Check that the code {http://hl7.org/fhir/v3/RoleCode}CHILD 'child' is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-4"/>
      <parameter value="system=http://hl7.org/fhir/v3/RoleCode"/>
      <parameter value="code=CHILD"/>
      <parameter value="display=child"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test3-4-b">
    <name value="Validation valueset #4 valid code invalid display"/>
    <description value="Check that the code {http://hl7.org/fhir/v3/RoleCode}CHILD 'child' is in the value set, but give the wrong display`"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-4"/>
      <parameter value="system=http://hl7.org/fhir/v3/RoleCode"/>
      <parameter value="code=CHILD"/>
      <parameter value="display=childX"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-4-c">
    <name value="Validation valueset #4 invalid system"/>
    <description value="Check that the code {http://hl7.org/fhir/v3/RoleCodeX}CHILD is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-4"/>
      <parameter value="system=http://hl7.org/fhir/v3/RoleCodeX"/>
      <parameter value="code=CHILD"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-4-d">
    <name value="Validation valueset #4 invalid code"/>
    <description value="Check that the code {http://hl7.org/fhir/v3/RoleCode}child is not in the value set (note: this coding system is case sensitive, so 'CHILD' is valid, but 'child' is not"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-4"/>
      <parameter value="system=http://hl7.org/fhir/v3/RoleCode"/>
      <parameter value="code=child"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-4-e">
    <name value="Validation valueset #4 valid code not in valid set"/>
    <description value="Check that the code {http://hl7.org/fhir/v3/RoleCode}FULLINS is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-4"/>
      <parameter value="system=http://hl7.org/fhir/v3/RoleCode"/>
      <parameter value="code=FULLINS"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

  <test id="test3-5-a">
    <name value="Validation valueset #5 valid"/>
    <description value="Check that the code {http://loinc.org}11377-9 'Diastolic blood pressure at First encounter' is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-1"/>
      <parameter value="system=http://loinc.org"/>
      <parameter value="code=11377-9"/>
      <parameter value="display=Diastolic%20blood%20pressure%20at%20First%20encounter"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test3-5-b">
    <name value="Validation valueset #5 valid code invalid display"/>
    <description value="Check that the code {http://loinc.org}11377-9 'Diastolic blood pressure at First encounter' is in the value set, but supply a wrong display"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-1"/>
      <parameter value="http://loinc.org"/>
      <parameter value="code=11377-9"/>
      <parameter value="display=Diastolic%20blood%20pressure%20at%20First%20encounterX"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-5-c">
    <name value="Validation valueset #5 invalid system"/>
    <description value="Check that the code {http://loinc.orgX}11377-9 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-1"/>
      <parameter value="system=http://loinc.orgX"/>
      <parameter value="code=11377-9"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-5-d">
    <name value="Validation valueset #5 invalid code"/>
    <description value="Check that the code {http://loinc.org}11377-9X is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-1"/>
      <parameter value="system=http://loinc.org"/>
      <parameter value="code=11377-9X"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-5-e">
    <name value="Validation valueset #5 valid code not in valid set"/>
    <description value="Check that the code {http://loinc.org}13457-7 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-1"/>
      <parameter value="system=http://loinc.org"/>
      <parameter value="code=13457-7"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

  <test id="test3-6-a">
    <name value="Validation valueset #6 valid"/>
    <description value="Check that the code {http://snomed.info/sct}8762007 'Chronic hypertension in obstetric context (disorder)' is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-2"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=8762007"/>
      <parameter value="display=Chronic%20hypertension%20in%20obstetric%20context%20(disorder)"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test3-6-b">
    <name value="Validation valueset #6 valid code invalid display"/>
    <description value="Check that the code {http://snomed.info/sct}8762007 'Chronic hypertension in obstetric context (disorder)' is in the value set, but give the wrong display`"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-2"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=8762007"/>
      <parameter value="display=Chronic%20hypertension%20in%20obstetric%20context%20(disorder)X"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-6-c">
    <name value="Validation valueset #6 invalid system"/>
    <description value="Check that the code {http://snomed.info/sctX}8762007 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-2"/>
      <parameter value="system=http://snomed.info/sctX"/>
      <parameter value="code=8762007"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-6-d">
    <name value="Validation valueset #6 invalid code"/>
    <description value="Check that the code {http://snomed.info/sct}8762007X is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-2"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=8762007X"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-6-e">
    <name value="Validation valueset #6 valid code not in valid set"/>
    <description value="Check that the code {http://snomed.info/sct}102261002 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-2"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=102261002"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

  <test id="test3-7-a">
    <name value="Validation valueset #7 valid"/>
    <description value="Check that the code {http://snomed.info/sct}8762007 'Chronic hypertension in obstetric context (disorder)' is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=8762007"/>
      <parameter value="display=Chronic%20hypertension%20in%20obstetric%20context%20(disorder)"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test3-7-b">
    <name value="Validation valueset #7 valid code invalid display"/>
    <description value="Check that the code {http://snomed.info/sct}8762007 'Chronic hypertension in obstetric context (disorder)' is in the value set, but give the wrong display`"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=8762007"/>
      <parameter value="display=Chronic%20hypertension%20in%20obstetric%20context%20(disorder)X"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-7-c">
    <name value="Validation valueset #7 invalid system"/>
    <description value="Check that the code {http://snomed.info/sctX}8762007 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-3"/>
      <parameter value="system=http://snomed.info/sctX"/>
      <parameter value="code=8762007"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-7-d">
    <name value="Validation valueset #7 invalid code"/>
    <description value="Check that the code {http://snomed.info/sct}8762007X is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=8762007X"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <test id="test3-7-e">
    <name value="Validation valueset #7 valid code not in valid set"/>
    <description value="Check that the code {http://snomed.info/sct}102261002 is not in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="intensional-case-3"/>
      <parameter value="system=http://snomed.info/sct"/>
      <parameter value="code=102261002"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>

<!-- These tests are from suite4 - Validation Tests - API variation -->
  <test id="test4-1-a">
    <name value="Valid - system/code parameters"/>
    <description value="Check that the code {http://hl7.org/fhir/patient-contact-relationship}emergency is in the value set"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-1"/>
      <parameter value="system=http://hl7.org/fhir/patient-contact-relationship"/>
      <parameter value="code=emergency"/>
      <parameter value="display=Emergency"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_code"/>
      <parameter value="200"/>
    </operation>
  </test>
  <test id="test4-1-b">
    <name value="Invalid display - system/code parameters"/>
    <description value="Check that the code {http://hl7.org/fhir/patient-contact-relationshipX}emergency is in the value set, but give the wrong display"/>
    <metadata>
      <link>
        <url value="http://fhir.org/spec.html"/>
        <description value="link to the FHIR specification"/>
      </link>
      <requires>
        <type value="ValueSet"/>
        <operations value="create, $validate"/>
      </requires>
      <validates>
        <type value="ValueSet"/>
        <operations value="$validate"/>
      </validates>
    </metadata>
    <operation>
      <type value="$validate"/>
      <target value="extensional-case-1"/>
      <parameter value="system=http://hl7.org/fhir/patient-contact-relationship"/>
      <parameter value="code=emergency"/>
      <parameter value="display=EmergencyX"/>
    </operation>
    <operation>
      <type value="assertion"/>
      <parameter value="response_not_okay"/>
    </operation>
  </test>
  <!-- Tests below require POSTing data with the $validate operation... -->
  <!-- <test id="test4-2-a"></test> -->
  <!-- <test id="test4-2-b"></test> -->
  <!-- <test id="test4-3-a"></test> -->
  <!-- <test id="test4-3-b"></test> -->
  <!-- <test id="test4-4-a"></test> -->
  <!-- <test id="test4-4-b"></test> -->

  <teardown>
    <operation>
      <type value="delete"/>
      <target value="extensional-case-1"/>
    </operation>
    <operation>
      <type value="delete"/>
      <target value="extensional-case-2"/>
    </operation>
    <operation>
      <type value="delete"/>
      <target value="extensional-case-3"/>
    </operation>
    <operation>
      <type value="delete"/>
      <target value="extensional-case-4"/>
    </operation>
    <operation>
      <type value="delete"/>
      <target value="intensional-case-1"/>
    </operation>
    <operation>
      <type value="delete"/>
      <target value="intensional-case-2"/>
    </operation>
    <operation>
      <type value="delete"/>
      <target value="intensional-case-3"/>
    </operation>
  </teardown>

</TestScript>
